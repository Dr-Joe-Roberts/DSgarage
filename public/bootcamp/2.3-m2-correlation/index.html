<!DOCTYPE html>
<html lang="en-us">
    <head>
        

        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>2.3 Correlation</title>
        
        <style>

    html body {
        font-family: 'Raleway', sans-serif;
        background-color: white;
    }

    :root {
        --accent: green;
        --border-width:  5px ;
    }

</style>


<link rel="stylesheet" href="/css/main.css">





<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway">


 <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"> 


<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">


<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
 

    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/go.min.js"></script>
    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/haskell.min.js"></script>
    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/kotlin.min.js"></script>
    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/scala.min.js"></script>
    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/swift.min.js"></script>
    
    <script>hljs.initHighlightingOnLoad();</script>






<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>


<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>


<script>$(document).on('click', function() { $('.collapse').collapse('hide'); })</script>
 <meta name="generator" content="Hugo 0.75.0" />
        

        

        
            <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        

        

    </head>

    <body>
        

        <nav class="navbar navbar-default navbar-fixed-top">
            <div class="container">
                <div class="navbar-header">
                    <a class="navbar-brand visible-xs" href="#">2.3 Correlation</a>
                    <button class="navbar-toggle" data-target=".navbar-collapse" data-toggle="collapse">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
                <div class="collapse navbar-collapse">
                    
                        <ul class="nav navbar-nav">
                            
                                <li><a href="/">Home</a></li>
                            
                                <li><a href="/about/">About</a></li>
                            
                                <li><a href="/bootcamp/">Bootcamp</a></li>
                            
                        </ul>
                    
                    
                        <ul class="nav navbar-nav navbar-right">
                            
                                <li class="navbar-icon"><a href="https://join.slack.com/t/hadatascience/shared_invite/zt-ekigo1t3-0ADgafsF6zTDwJ9SxIws9w"><i class="fa fa-slack"></i></a></li>
                            
                                <li class="navbar-icon"><a href="https://twitter.com/adams_data/"><i class="fa fa-twitter"></i></a></li>
                            
                                <li class="navbar-icon"><a href="https://www.youtube.com/channel/UCOEuOH6cY8yisodud25hb7w"><i class="fa fa-youtube"></i></a></li>
                            
                        </ul>
                    
                </div>
            </div>
        </nav>


<main>

    <div>
        <h2>2.3 Correlation</h2>
        <h5></h5>
        
<a href="/tags/bootcamp"><kbd class="item-tag">Bootcamp</kbd></a>

<a href="/tags/r"><kbd class="item-tag">R</kbd></a>

<a href="/tags/statistics"><kbd class="item-tag">Statistics</kbd></a>


    </div>

    <div align="start" class="content"><p><img src="/img/murmur.png" alt=" "></p>
<p> </p>
<p> </p>
<h2 id="correlation">Correlation</h2>
<p> </p>
<p><a href="/scripts/script-2.3.R">SCRIPT 2.3</a> Use this to follow along on this page and for the Practice exercises below.</p>
<p> </p>
<p><strong>Overview</strong></p>
<blockquote>
<p>Most of you will have heard the maxim &ldquo;<strong>correlation does not imply causation</strong>&rdquo;. Just because two variables have a statistical relationship with each other does not mean that one is responsible for the other. For instance, ice cream sales and forest fires are correlated because both occur more often in the summer heat. But there is no causation; you don&rsquo;t light a patch of the Montana brush on fire when you buy a pint of Haagan-Dazs. - Nate Silver</p>
</blockquote>
<p>Correlation is used in many applications and is a basic tool in the data science toolbox.  We use it to to describe, and sometimes to test, the relationship between two numeric variables, principally to ask whether there is or is not a relationship between the variables (and if there is, whether they tend to vary positively (both tend to increase in value) or negatively (one tends to decrease as the other increases).</p>
<p> </p>
<p><strong>Contents</strong></p>
<p><a href="#anchor-1">2.3.1 The question of correlation</a></p>
<p><a href="#anchor-2">2.3.2 Data and assumptions</a></p>
<p><a href="#anchor-3">2.3.3 Graphing</a></p>
<p><a href="#anchor-4">2.3.4 Test and alternatives</a></p>
<p><a href="#anchor-5">2.3.5 Practice exercises</a></p>
<h1 id="anchor-1"></h1>
<p> </p>
<p> </p>
<h3 id="231-the-question-of-correlation">2.3.1 The question of correlation</h3>
<p><strong>The question</strong> of correlation is simply whether there is a demonstrable <strong>association</strong> between two numeric variables.  For example, we might wonder this for two numeric variables, such as a measure of vegetation biomass and a measure of insect abundance.  Digging a little deeper, we are interested in seeing and quantifying whether and how the variables may <strong>&ldquo;co-vary&rdquo;</strong> (i.e, exhibit significant covariance). This covariance may be quantified as being either positive or negative and may vary in strength from zero, to perfect positive or negative correlation (+1, or -1).  We traditionally visualise correlation with a <strong>scatterplot</strong> (<code>plot()</code> in R).  If there is a relationship, the degree of &ldquo;scatter&rdquo; is related to strength of the correlation (more scatter = a weaker correlation).</p>
<p>E.g., we can see in the figure below that the two variables tend to increase with each other positively, suggesting a positive correlation.</p>
<p><img src="/img/2.3-pos-cor.png" alt=""></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#75715e"># Try this:</span>

<span style="color:#75715e"># Flash challenge</span>
<span style="color:#75715e"># Take the data input below and try to exactly recreate the figure above!</span>

veg <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">101.7</span>, <span style="color:#ae81ff">101.2</span>, <span style="color:#ae81ff">97.1</span>, <span style="color:#ae81ff">92.4</span>, <span style="color:#ae81ff">91</span>, <span style="color:#ae81ff">99.4</span>, <span style="color:#ae81ff">104.2</span>, <span style="color:#ae81ff">115.9</span>, <span style="color:#ae81ff">91.9</span>, <span style="color:#ae81ff">101.4</span>, 
<span style="color:#ae81ff">93.5</span>, <span style="color:#ae81ff">87.2</span>, <span style="color:#ae81ff">89.2</span>, <span style="color:#ae81ff">92.8</span>, <span style="color:#ae81ff">103.1</span>, <span style="color:#ae81ff">116.4</span>, <span style="color:#ae81ff">95.2</span>, <span style="color:#ae81ff">80.9</span>, <span style="color:#ae81ff">94.9</span>, <span style="color:#ae81ff">88.8</span>, 
<span style="color:#ae81ff">108.2</span>, <span style="color:#ae81ff">86.1</span>, <span style="color:#ae81ff">104.1</span>, <span style="color:#ae81ff">101.5</span>, <span style="color:#ae81ff">116.9</span>, <span style="color:#ae81ff">109.6</span>, <span style="color:#ae81ff">103.7</span>, <span style="color:#ae81ff">83.9</span>, <span style="color:#ae81ff">85.9</span>, <span style="color:#ae81ff">88.5</span>, 
<span style="color:#ae81ff">98.9</span>, <span style="color:#ae81ff">98.8</span>, <span style="color:#ae81ff">107.8</span>, <span style="color:#ae81ff">86.5</span>, <span style="color:#ae81ff">92.6</span>, <span style="color:#ae81ff">76</span>, <span style="color:#ae81ff">95.2</span>, <span style="color:#ae81ff">105.3</span>, <span style="color:#ae81ff">103.1</span>, <span style="color:#ae81ff">89.3</span>, 
<span style="color:#ae81ff">100.1</span>, <span style="color:#ae81ff">103.1</span>, <span style="color:#ae81ff">87.7</span>, <span style="color:#ae81ff">92.4</span>, <span style="color:#ae81ff">91.5</span>, <span style="color:#ae81ff">105.4</span>, <span style="color:#ae81ff">105.7</span>, <span style="color:#ae81ff">90.5</span>, <span style="color:#ae81ff">105.6</span>, <span style="color:#ae81ff">101.6</span>, 
<span style="color:#ae81ff">97.4</span>, <span style="color:#ae81ff">93.4</span>, <span style="color:#ae81ff">88.7</span>, <span style="color:#ae81ff">81.1</span>, <span style="color:#ae81ff">100.9</span>, <span style="color:#ae81ff">91.6</span>, <span style="color:#ae81ff">102.4</span>, <span style="color:#ae81ff">92.8</span>, <span style="color:#ae81ff">92</span>, <span style="color:#ae81ff">97.1</span>, <span style="color:#ae81ff">91.1</span>, 
<span style="color:#ae81ff">97.3</span>, <span style="color:#ae81ff">104</span>, <span style="color:#ae81ff">99</span>, <span style="color:#ae81ff">101.5</span>, <span style="color:#ae81ff">112.8</span>, <span style="color:#ae81ff">82.4</span>, <span style="color:#ae81ff">84.9</span>, <span style="color:#ae81ff">116.3</span>, <span style="color:#ae81ff">92.2</span>, <span style="color:#ae81ff">106.2</span>, 
<span style="color:#ae81ff">94.2</span>, <span style="color:#ae81ff">89.6</span>, <span style="color:#ae81ff">108.8</span>, <span style="color:#ae81ff">106.2</span>, <span style="color:#ae81ff">91</span>, <span style="color:#ae81ff">95.5</span>, <span style="color:#ae81ff">99.1</span>, <span style="color:#ae81ff">111.6</span>, <span style="color:#ae81ff">124.1</span>, <span style="color:#ae81ff">100.8</span>, 
<span style="color:#ae81ff">117.6</span>, <span style="color:#ae81ff">118.6</span>, <span style="color:#ae81ff">115.8</span>, <span style="color:#ae81ff">102.2</span>, <span style="color:#ae81ff">107.7</span>, <span style="color:#ae81ff">105</span>, <span style="color:#ae81ff">86.7</span>, <span style="color:#ae81ff">99</span>, <span style="color:#ae81ff">101.8</span>, <span style="color:#ae81ff">106.3</span>, 
<span style="color:#ae81ff">100.3</span>, <span style="color:#ae81ff">86.6</span>, <span style="color:#ae81ff">106.4</span>, <span style="color:#ae81ff">92.6</span>, <span style="color:#ae81ff">108.2</span>, <span style="color:#ae81ff">100.5</span>, <span style="color:#ae81ff">100.9</span>, <span style="color:#ae81ff">116.4</span>)

arth <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">1002</span>, <span style="color:#ae81ff">1006</span>, <span style="color:#ae81ff">930</span>, <span style="color:#ae81ff">893</span>, <span style="color:#ae81ff">963</span>, <span style="color:#ae81ff">998</span>, <span style="color:#ae81ff">1071</span>, <span style="color:#ae81ff">1052</span>, <span style="color:#ae81ff">997</span>, <span style="color:#ae81ff">1044</span>, <span style="color:#ae81ff">923</span>, 
<span style="color:#ae81ff">988</span>, <span style="color:#ae81ff">1022</span>, <span style="color:#ae81ff">975</span>, <span style="color:#ae81ff">1022</span>, <span style="color:#ae81ff">1050</span>, <span style="color:#ae81ff">929</span>, <span style="color:#ae81ff">928</span>, <span style="color:#ae81ff">1019</span>, <span style="color:#ae81ff">957</span>, <span style="color:#ae81ff">1054</span>, <span style="color:#ae81ff">850</span>, <span style="color:#ae81ff">1084</span>, 
<span style="color:#ae81ff">995</span>, <span style="color:#ae81ff">1065</span>, <span style="color:#ae81ff">1039</span>, <span style="color:#ae81ff">1009</span>, <span style="color:#ae81ff">945</span>, <span style="color:#ae81ff">995</span>, <span style="color:#ae81ff">967</span>, <span style="color:#ae81ff">916</span>, <span style="color:#ae81ff">998</span>, <span style="color:#ae81ff">988</span>, <span style="color:#ae81ff">956</span>, <span style="color:#ae81ff">975</span>, 
<span style="color:#ae81ff">910</span>, <span style="color:#ae81ff">954</span>, <span style="color:#ae81ff">1044</span>, <span style="color:#ae81ff">1063</span>, <span style="color:#ae81ff">948</span>, <span style="color:#ae81ff">966</span>, <span style="color:#ae81ff">1037</span>, <span style="color:#ae81ff">976</span>, <span style="color:#ae81ff">979</span>, <span style="color:#ae81ff">969</span>, <span style="color:#ae81ff">1009</span>, <span style="color:#ae81ff">1076</span>, 
<span style="color:#ae81ff">943</span>, <span style="color:#ae81ff">1024</span>, <span style="color:#ae81ff">1071</span>, <span style="color:#ae81ff">969</span>, <span style="color:#ae81ff">963</span>, <span style="color:#ae81ff">1020</span>, <span style="color:#ae81ff">936</span>, <span style="color:#ae81ff">1004</span>, <span style="color:#ae81ff">961</span>, <span style="color:#ae81ff">1089</span>, <span style="color:#ae81ff">953</span>, <span style="color:#ae81ff">1037</span>, 
<span style="color:#ae81ff">962</span>, <span style="color:#ae81ff">977</span>, <span style="color:#ae81ff">958</span>, <span style="color:#ae81ff">944</span>, <span style="color:#ae81ff">933</span>, <span style="color:#ae81ff">970</span>, <span style="color:#ae81ff">1036</span>, <span style="color:#ae81ff">960</span>, <span style="color:#ae81ff">912</span>, <span style="color:#ae81ff">978</span>, <span style="color:#ae81ff">967</span>, <span style="color:#ae81ff">1035</span>, 
<span style="color:#ae81ff">959</span>, <span style="color:#ae81ff">831</span>, <span style="color:#ae81ff">1016</span>, <span style="color:#ae81ff">901</span>, <span style="color:#ae81ff">1010</span>, <span style="color:#ae81ff">1072</span>, <span style="color:#ae81ff">1019</span>, <span style="color:#ae81ff">996</span>, <span style="color:#ae81ff">1122</span>, <span style="color:#ae81ff">1029</span>, <span style="color:#ae81ff">1047</span>, 
<span style="color:#ae81ff">1132</span>, <span style="color:#ae81ff">996</span>, <span style="color:#ae81ff">979</span>, <span style="color:#ae81ff">994</span>, <span style="color:#ae81ff">970</span>, <span style="color:#ae81ff">976</span>, <span style="color:#ae81ff">997</span>, <span style="color:#ae81ff">950</span>, <span style="color:#ae81ff">1002</span>, <span style="color:#ae81ff">1003</span>, <span style="color:#ae81ff">982</span>, <span style="color:#ae81ff">1071</span>, 
<span style="color:#ae81ff">959</span>, <span style="color:#ae81ff">976</span>, <span style="color:#ae81ff">1011</span>, <span style="color:#ae81ff">1032</span>, <span style="color:#ae81ff">1024</span>)
</code></pre></div><p> </p>
<h1 id="anchor-2"></h1>
<p> </p>
<p> </p>
<h3 id="232-data-and-assumptions">2.3.2 Data and assumptions</h3>
<p><strong>Pearson correlation</strong></p>
<p>&ldquo;Traditional correlation&rdquo; is sometimes referred to as the <a href="https://en.wikipedia.org/wiki/Pearson_correlation_coefficient">Pearson correlation</a>.  The data and assumptions are important for the Pearson correlation - we use this when there is a linear relationship between our variables of interest, and the numeric values are Guassian distributed.</p>
<p>More technically, the Pearson correlation coefficient is the <strong>covariance</strong> of two variables, divided by the product of their standard deviations:</p>
<p> </p>
<p><img src="/img/2.3-r.png" alt=""></p>
<p> </p>
<p>The correlation coefficient can be calculated in R using the <code>cor()</code> function.</p>
<p> </p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#75715e"># Try this:</span>
<span style="color:#75715e"># use veg and arth from above</span>

<span style="color:#75715e"># r the &#34;hard way&#34;</span>

<span style="color:#75715e"># r = ((covariance of x,y) / (std dev x * std dev y) )</span>


<span style="color:#75715e"># sample covariance (hard way)</span>
(cov_veg_arth <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">sum</span>( (veg<span style="color:#f92672">-</span><span style="color:#a6e22e">mean</span>(veg))<span style="color:#f92672">*</span>(arth<span style="color:#f92672">-</span><span style="color:#a6e22e">mean</span>(arth))) <span style="color:#f92672">/</span> (<span style="color:#a6e22e">length</span>(veg) <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span> ))

<span style="color:#a6e22e">cov</span>(veg,arth) <span style="color:#75715e"># easy way</span>

<span style="color:#75715e"># r the &#34;hard way&#34;</span>
(r_arth_veg <span style="color:#f92672">&lt;-</span> cov_veg_arth <span style="color:#f92672">/</span> (<span style="color:#a6e22e">sd</span>(veg) <span style="color:#f92672">*</span> <span style="color:#a6e22e">sd</span>(arth)))

<span style="color:#75715e"># r the easy way</span>
<span style="color:#a6e22e">help</span>(cor)
<span style="color:#a6e22e">cor</span>(x <span style="color:#f92672">=</span> veg, y <span style="color:#f92672">=</span> arth,
    method <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;pearson&#34;</span>) <span style="color:#75715e"># NB &#34;pearson&#34; is the default method if unspecified</span>
</code></pre></div><h1 id="anchor-3"></h1>
<p> </p>
<p> </p>
<h3 id="233-graphing">2.3.3 Graphing</h3>
<p>We can look at a range of different correlation magnitudes, to think about dignosing correlation.</p>
<p><img src="/img/2.3-diff-r.png" alt=""></p>
<p> </p>
<p>If we really care and value making a correlation between 2 specific variables, traditionally we would use the scatterplot like above with the veg and arth data, and the calculation of the correlation coefficient (using <code>plot()</code> and <code>cor()</code> respectively).  On the other hand, we might have loads of variables and just want to quickly assess the degree of correlation and intercorrelation.  To do this we might just make and print a matric of the correlation plot (using <code>pairs()</code>) and the correlation matrix (again using <code>cor()</code>)</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#75715e">## Correlation matrices ####</span>
<span style="color:#75715e"># Try this:</span>

<span style="color:#75715e"># Use the iris data to look at correlation matrix </span>
<span style="color:#75715e"># of flower measures</span>
<span style="color:#a6e22e">data</span>(iris)
<span style="color:#a6e22e">names</span>(iris)
<span style="color:#a6e22e">cor</span>(iris[ , <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">4</span>]) <span style="color:#75715e"># all rows, just the numeric columns</span>

<span style="color:#75715e"># fix the decimal output</span>
<span style="color:#a6e22e">round</span>(<span style="color:#a6e22e">cor</span>(iris[ , <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">4</span>]), <span style="color:#ae81ff">2</span>) <span style="color:#75715e"># nicer</span>

<span style="color:#75715e"># pairs plot</span>
<span style="color:#a6e22e">pairs</span>(iris[ , <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">4</span>], pch <span style="color:#f92672">=</span> <span style="color:#ae81ff">16</span>, 
      col <span style="color:#f92672">=</span> iris<span style="color:#f92672">$</span>Species) <span style="color:#75715e"># Set color to species...</span>
</code></pre></div><p><code>R output</code></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">round</span>(<span style="color:#a6e22e">cor</span>(iris[ , <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">4</span>]), <span style="color:#ae81ff">2</span>) <span style="color:#75715e"># nicer</span>
             Sepal.Length Sepal.Width Petal.Length Petal.Width
Sepal.Length         <span style="color:#ae81ff">1.00</span>       <span style="color:#ae81ff">-0.12</span>         <span style="color:#ae81ff">0.87</span>        <span style="color:#ae81ff">0.82</span>
Sepal.Width         <span style="color:#ae81ff">-0.12</span>        <span style="color:#ae81ff">1.00</span>        <span style="color:#ae81ff">-0.43</span>       <span style="color:#ae81ff">-0.37</span>
Petal.Length         <span style="color:#ae81ff">0.87</span>       <span style="color:#ae81ff">-0.43</span>         <span style="color:#ae81ff">1.00</span>        <span style="color:#ae81ff">0.96</span>
Petal.Width          <span style="color:#ae81ff">0.82</span>       <span style="color:#ae81ff">-0.37</span>         <span style="color:#ae81ff">0.96</span>        <span style="color:#ae81ff">1.00</span>
</code></pre></div><p><img src="/img/2.3-iris-pairs.png" alt=""></p>
<p> </p>
<p>In this case, we can see that the correlation of plant parts is very strongly influenced by species!  For further exploration we would definitely want to explore and address that, thus here we have shown how powerful the combination of statistical summary and graphing can be.</p>
<h1 id="anchor-4"></h1>
<p> </p>
<p> </p>
<h3 id="234-test-and-alternatives">2.3.4 Test and alternatives</h3>
<p>We may want to perform a statistical test to determine whether a correlation coefficient is &ldquo;significantly&rdquo; different to zero, using Null Hypothesis Significance Testing.  There are a lot of options, but a simple solution is to use the <code>cor.test()</code> function.</p>
<p>An alternative to the <strong>Pearson correlation</strong> (the traditionl correlation, assuming the variables in question are Gaussian), is the <strong>Spearman rank correlation</strong>, which can be used when the assumptions for the Pearson correlation are not met.  We will briefly perform both tests.</p>
<p><a href="http://www.biostathandbook.com/linearregression.html">See here for further information on Pearson correlation</a></p>
<p><a href="http://www.biostathandbook.com/spearman.html">See here for further information on Spearman rank correlation</a></p>
<p>Briefly, the principle assumptions of the Pearson correlation are:</p>
<ul>
<li>
<p>The relationship between the variables is linear (i.e., not a curved relationship)</p>
</li>
<li>
<p>The variables exhibit a bivariate Gaussian distribution (in pactice, it is often accepted that each variable is Gaussian)</p>
</li>
<li>
<p>Homoscedasticity (i.e., the variance is similar across the range of the variables)</p>
</li>
<li>
<p>Observations are independent</p>
</li>
<li>
<p>Absence of outliers</p>
</li>
</ul>
<p> </p>
<p><a href="https://statistics.laerd.com/statistical-guides/pearson-correlation-coefficient-statistical-guide.php">Discussion of assumptions</a></p>
<p><a href="https://rafalab.github.io/dsbook/association-is-not-causation.html">Further practical information about correlation</a></p>
<p> </p>
<p>Let&rsquo;s try a statistical test of correlation.  We need to keep in mind an order of operation for statistical analysis, e.g.:</p>
<p>1 Question</p>
<p>2 Graph</p>
<p>3 Test</p>
<p>4 Validate (e.g. test assumptions)</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#75715e">## Correlation test ####</span>
<span style="color:#75715e"># Try this:</span>

<span style="color:#75715e"># 1 Question: whether Petal length and width are correlated</span>

<span style="color:#75715e"># 2 Graph</span>
<span style="color:#a6e22e">plot</span>(iris<span style="color:#f92672">$</span>Petal.Width, iris<span style="color:#f92672">$</span>Petal.Length,
     xlab <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Petal width&#34;</span>,
     ylab <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Petal length&#34;</span>,
     col <span style="color:#f92672">=</span> iris<span style="color:#f92672">$</span>Species, pch <span style="color:#f92672">=</span> <span style="color:#ae81ff">16</span>)

<span style="color:#75715e"># 3 Test</span>
<span style="color:#a6e22e">cor.test</span>(iris<span style="color:#f92672">$</span>Petal.Width, iris<span style="color:#f92672">$</span>Petal.Length)
</code></pre></div><p><img src="/img/2.3-iris-petal.png" alt=""></p>
<p><code>R output</code></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">cor.test</span>(iris<span style="color:#f92672">$</span>Petal.Width, iris<span style="color:#f92672">$</span>Petal.Length)

	Pearson<span style="color:#e6db74">&#39;</span><span style="color:#960050;background-color:#1e0010">s product-moment correlation</span>

data<span style="color:#f92672">:</span>  iris<span style="color:#f92672">$</span>Petal.Width and iris<span style="color:#f92672">$</span>Petal.Length
t <span style="color:#f92672">=</span> <span style="color:#ae81ff">43.387</span>, df <span style="color:#f92672">=</span> <span style="color:#ae81ff">148</span>, p<span style="color:#f92672">-</span>value <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">2.2e-16</span>
alternative hypothesis<span style="color:#f92672">:</span> true correlation is not equal to <span style="color:#ae81ff">0</span>
<span style="color:#ae81ff">95</span> percent confidence interval<span style="color:#f92672">:</span>
 <span style="color:#ae81ff">0.9490525</span> <span style="color:#ae81ff">0.9729853</span>
sample estimates<span style="color:#f92672">:</span>
      cor 
<span style="color:#ae81ff">0.9628654</span> 
</code></pre></div><p> </p>
<p><strong>Note about results and reporting</strong></p>
<p>When we do report or document the results of an analysis, we we would do it in different ways depending on the intended audience.</p>
<p><strong>Documenting results only for ourselves</strong></p>
<p>It would be typical to just comment the R script and have your script and data file in fully reproducible format.  This format would also work for close colleague (who also use R), or collaborators, to use to share or develop the analysis.  Even in this format, care should be taken to <em>clean up</em> redundant or unnecessary code, and to organize the script as much as possible in a logical way, e.g. by pairing graphs with relevant analysis outputs, removing analyses that were tried but obsolete (e.g. because a better analysis was found), etc.</p>
<p><strong>Documenting results to summarize to others</strong></p>
<p>Here it would be typical to summarize and format output results and figures in a way that is most easy to consume for the intended audience.  There should NEVER BE RAW COPIED AND PASTED STATISTICAL RESULTS (omg!).  A good way to do this would be to use R Markdown to format your script to produce an attractive summary, in html, MS Word, or pdf formats (amongst others).  Second best (primarily because it is more work and harder to edit or update) would be to format results in word processed document (like pdf, Word, etc.).</p>
<p><strong>Statistical summary</strong></p>
<p>Most statistical tests under NHST will have 3 quantities reported for each test: the test statistic (different for each test, &ldquo;r&rdquo; for Pearson correlation), the sample size or degrees of freedom, and the p-value.  For our results above, it might be something like:</p>
<blockquote>
<p>We found a significant correlation between petal width and length (Pearson&rsquo;s r = 0.96, df = 148, P &lt; 0.0001)</p>
</blockquote>
<p>NB the rounding of decimal accuracy, and the formatting of the p-value.  The 95% confidence interval of the estimate of r is also produced (remember, we are making an inference on the greater population from which our sample was drawn), and we might also report that in our descriptive summary of results, if it is deemed important.</p>
<p> </p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#75715e"># 4 Validate</span>
<span style="color:#a6e22e">hist</span>(iris<span style="color:#f92672">$</span>Petal.Length) <span style="color:#75715e"># Ummm..</span>
<span style="color:#a6e22e">hist</span>(iris<span style="color:#f92672">$</span>Petal.Width) <span style="color:#75715e"># Yuck</span>

<span style="color:#75715e"># We violate the assumption of Gaussian</span>

<span style="color:#75715e"># ... Relatedly, we also violate the assumption of independence </span>
<span style="color:#75715e"># due to similarities within and differences between species!</span>

</code></pre></div><p> </p>
<p><strong>Flash challenge</strong></p>
<p>Write a script following the steps to question, graph, test, and validate for each iris species separately.  Do these test validate?  How does the estimate of correlation compare amongst the species?</p>
<p> </p>
<p><strong>Correlation alternatives to Pearson&rsquo;s</strong></p>
<p>There are several alternative correlation estiamte frameworks to the Pearson&rsquo;s; we will briefly look at the application of the Spearman correlation.  THe main difference isa  relaxation of assumptions.  Here the main assumption is that:</p>
<ul>
<li>
<p>The data are ranked or otherwise ordered</p>
</li>
<li>
<p>The data rows are independent</p>
</li>
</ul>
<p>Hence, rank Spearman rank correlation descriptive cefficient and test are appropriate even if the data are not bivariate Gaussian or if the data are not strictly linear in their relationship.</p>
<p> </p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#75715e"># Spearman rank correlation ####</span>

<span style="color:#75715e"># Try this:</span>

height <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">18.4</span>, <span style="color:#ae81ff">3.2</span>, <span style="color:#ae81ff">6.4</span>, <span style="color:#ae81ff">3.6</span>, <span style="color:#ae81ff">13.2</span>, <span style="color:#ae81ff">3.6</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">5.9</span>, <span style="color:#ae81ff">13.5</span>, <span style="color:#ae81ff">10.8</span>, <span style="color:#ae81ff">9.7</span>, <span style="color:#ae81ff">10.9</span>, 
<span style="color:#ae81ff">18.8</span>, <span style="color:#ae81ff">11.6</span>, <span style="color:#ae81ff">9.8</span>, <span style="color:#ae81ff">14.4</span>, <span style="color:#ae81ff">19.6</span>, <span style="color:#ae81ff">14.7</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">16.8</span>, <span style="color:#ae81ff">18.2</span>, <span style="color:#ae81ff">16.9</span>, <span style="color:#ae81ff">19.8</span>, 
<span style="color:#ae81ff">18.2</span>, <span style="color:#ae81ff">2.6</span>, <span style="color:#ae81ff">18.8</span>, <span style="color:#ae81ff">8.4</span>, <span style="color:#ae81ff">18.9</span>, <span style="color:#ae81ff">9.5</span>, <span style="color:#ae81ff">19</span>)

vol <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">16.7</span>, <span style="color:#ae81ff">17.8</span>, <span style="color:#ae81ff">17.9</span>, <span style="color:#ae81ff">21.1</span>, <span style="color:#ae81ff">21.2</span>, <span style="color:#ae81ff">21.4</span>, <span style="color:#ae81ff">23.2</span>, <span style="color:#ae81ff">25.7</span>, <span style="color:#ae81ff">26.1</span>, <span style="color:#ae81ff">26.4</span>, 
<span style="color:#ae81ff">26.8</span>, <span style="color:#ae81ff">27</span>, <span style="color:#ae81ff">27.8</span>, <span style="color:#ae81ff">28.2</span>, <span style="color:#ae81ff">28.5</span>, <span style="color:#ae81ff">28.6</span>, <span style="color:#ae81ff">28.7</span>, <span style="color:#ae81ff">29.1</span>, <span style="color:#ae81ff">30.2</span>, <span style="color:#ae81ff">31</span>, <span style="color:#ae81ff">32.3</span>, 
<span style="color:#ae81ff">32.3</span>, <span style="color:#ae81ff">32.5</span>, <span style="color:#ae81ff">33.2</span>, <span style="color:#ae81ff">33.5</span>, <span style="color:#ae81ff">33.8</span>, <span style="color:#ae81ff">35.2</span>, <span style="color:#ae81ff">36.1</span>, <span style="color:#ae81ff">36.6</span>, <span style="color:#ae81ff">39.5</span>)

<span style="color:#a6e22e">plot</span>(height, vol,
     xlab <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Height&#34;</span>,
     ylab <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Volume&#34;</span>,
     pch <span style="color:#f92672">=</span> <span style="color:#ae81ff">16</span>, col <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;blue&#34;</span>, cex <span style="color:#f92672">=</span> <span style="color:#ae81ff">.7</span>)

<span style="color:#75715e"># Spearman coefficient</span>
<span style="color:#a6e22e">cor</span>(height, vol, method <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;spearman&#34;</span>)

<span style="color:#75715e"># Spearman test</span>
<span style="color:#a6e22e">cor.test</span>(height, vol, method <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;spearman&#34;</span>)
</code></pre></div><p><img src="/img/2.3-spearman-plot.png" alt=""></p>
<p><code>R output</code></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">cor</span>(height, vol, method <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;spearman&#34;</span>)
[1] <span style="color:#ae81ff">0.3945026</span>

<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">cor.test</span>(height, vol, method <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;spearman&#34;</span>)

	Spearmans rank correlation rho

data<span style="color:#f92672">:</span>  height and vol
S <span style="color:#f92672">=</span> <span style="color:#ae81ff">2721.7</span>, p<span style="color:#f92672">-</span>value <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.03098</span>
alternative hypothesis<span style="color:#f92672">:</span> true rho is not equal to <span style="color:#ae81ff">0</span>
sample estimates<span style="color:#f92672">:</span>
      rho 
<span style="color:#ae81ff">0.3945026</span> 
</code></pre></div><p>NB the correlation coefficient for the Spearman rank coprrelation is notated as &ldquo;rho&rdquo; (the Greek letter), reported and interpreted exactly like the Pearson correlation coefficient, r.</p>
<h1 id="anchor-5"></h1>
<p> </p>
<p> </p>
<h3 id="235-practice-exercises">2.3.5 Practice exercises</h3>
<p>For the following exercises, use 2 datasets: the <code>waders</code> data from the package {MASS}, and the <a href="/data/2.3-cfseal.xlsx">cape furs dataset <code>cfseals</code> you can download here</a></p>
<p> </p>
<p><strong>1</strong> Load the <code>waders</code> data and read the help page.  Use the pairs function on the data and make a statement about the overall degree of intercorrelation between variables based on the graphical output.</p>
<p> </p>
<p><strong>2</strong> Think about the variables and data themselves in <code>waders</code>. Do you expect the data to be Gaussian?  Formulate hypothesis statements for correlations amongst the first 3 columns of bird species in the dataset.  Show the code to make 3 good graphs (i.e., one for each pairwise comparison for the first 3 columns), and perform the 3 correlation tests.</p>
<p> </p>
<p><strong>3</strong> Validate the test performed in question 2.  Which form of correlation was performed, and why.  Show the code for any diagnostic tests performed, and any adjustment to the analysis required.  Formally report the results of your validated results.</p>
<p> </p>
<p><strong>4</strong> Load the <code>2.3-cfseal.xlsx</code> data and examine the information in the data dictionary. Analyse the correlations amongst the weight heart and lung variables, utilising the 1 question, 2 graph, 3 test and 4 validate workflow.  Show your code and briefly report the results.</p>
<p> </p>
<p><strong>5</strong> Comment on the expectation of Gaussian for the <code>age</code> variable in the <code>cfseal</code> data.  WOuld expect this variable to be Gaussian?  Briefly explain you answer and analyse the correlation between weight and age, using our 4 step workflow and briefly report your results.</p>
<p> </p>
<p><strong>6</strong> Write a plausible practice question involving any aspect of the use of correlation, and our woprkflow.  Make use of the data from either the <code>waders</code> data, or else the <code>cfseal</code> data.</p>
<p> </p>
</div>

</main>

        <footer>
            <p class="copyright text-muted">© All rights reserved. Powered by <a href="https://gohugo.io">Hugo</a> and <a href="https://github.com/calintat/minimal">Minimal</a>.</p>
        </footer>

        

        
    </body>

</html>

